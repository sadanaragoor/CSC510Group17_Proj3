{% extends "base.html" %}

{% block title %}Payment Failed - Stack Shack{% endblock %}

{% block content %}
<div style="max-width: 700px; margin: 60px auto; padding: 20px; text-align: center;">
    <div style="background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <!-- Failure Icon -->
        <div style="width: 100px; height: 100px; background: #dc3545; border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; font-size: 3em; color: white;">
            âœ—
        </div>
        
        <h1 style="color: #dc3545; margin-bottom: 10px;">Payment Failed</h1>
        <p style="font-size: 1.1em; color: #666; margin-bottom: 30px;">
            We were unable to process your payment. Please try again.
        </p>
        
        <!-- Failure Details -->
        {% if transaction %}
        <div style="background: #f8d7da; border: 1px solid #f5c2c7; padding: 20px; border-radius: 8px; margin: 30px 0; text-align: left;">
            <h3 style="margin-top: 0; color: #842029;">Transaction Details</h3>
            <div style="display: grid; grid-template-columns: auto 1fr; gap: 10px 20px; font-size: 0.95em;">
                <strong>Transaction ID:</strong>
                <span style="font-family: monospace;">{{ transaction.transaction_id }}</span>
                
                <strong>Order ID:</strong>
                <span>#{{ transaction.order_id }}</span>
                
                <strong>Amount:</strong>
                <span>${{ "%.2f"|format(transaction.amount) }}</span>
                
                <strong>Payment Method:</strong>
                <span>{{ transaction.payment_method.replace('_', ' ').title() }}</span>
                
                <strong>Time:</strong>
                <span>{{ transaction.initiated_at.strftime('%Y-%m-%d %H:%M:%S') if transaction.initiated_at else 'N/A' }}</span>
                
                {% if transaction.failure_reason %}
                <strong>Failure Reason:</strong>
                <span style="color: #dc3545; font-weight: bold;">{{ transaction.failure_reason }}</span>
                {% endif %}
            </div>
        </div>
        {% endif %}
        
        <!-- Common Issues -->
        <div style="background: #fff3cd; border: 1px solid #ffc107; padding: 20px; border-radius: 8px; margin: 30px 0; text-align: left;">
            <h4 style="margin-top: 0; color: #664d03;">Common Issues & Solutions</h4>
            <ul style="margin: 10px 0 0 20px; color: #664d03;">
                <li><strong>Insufficient Funds:</strong> Check your account/card balance</li>
                <li><strong>Expired Card:</strong> Update your card expiry date</li>
                <li><strong>Invalid Details:</strong> Double-check card number, CVV, and expiry</li>
                <li><strong>Campus Card:</strong> Add more balance to your campus card</li>
                <li><strong>Wallet Issues:</strong> Ensure your wallet account is active</li>
            </ul>
        </div>
        
        <!-- Action Buttons -->
        <div style="display: flex; gap: 15px; margin-top: 30px; justify-content: center; flex-wrap: wrap;">
            <a href="{{ url_for('payment.checkout', order_id=order.id) }}"
               style="padding: 12px 25px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 4px; font-weight: bold; transition: all 0.3s;">
                ðŸ”„ Try Again
            </a>
            
            <a href="{{ url_for('payment.checkout', order_id=order.id) }}"
               style="padding: 12px 25px; background: var(--secondary-color); color: white; text-decoration: none; border-radius: 4px; font-weight: bold; transition: all 0.3s;">
                ðŸ’³ Use Different Payment Method
            </a>
            
            <a href="{{ url_for('order.order_history') }}"
               style="padding: 12px 25px; background: #6c757d; color: white; text-decoration: none; border-radius: 4px; font-weight: bold; transition: all 0.3s;">
                ðŸ“‹ Back to Orders
            </a>
        </div>
        
        <!-- Help Section -->
        <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: left;">
            <h4 style="margin-top: 0; color: var(--secondary-color);">Need Help?</h4>
            <p style="margin: 10px 0;">
                If you continue experiencing issues, please contact our support team:
            </p>
            <ul style="margin: 10px 0 0 20px;">
                <li>Email: support@stackshack.com</li>
                <li>Phone: 1-800-STACK-SHACK</li>
                <li>Live Chat: Available 24/7</li>
            </ul>
        </div>
        
        <!-- Order Info -->
        <div style="margin-top: 20px; padding: 15px; background: #e8f4f8; border-radius: 8px;">
            <p style="margin: 0; font-size: 0.9em; color: #666;">
                ðŸ’¡ <strong>Note:</strong> Your order is still pending. Complete payment within 30 minutes to avoid cancellation.
            </p>
        </div>
    </div>
</div>

<style>
    a:hover {
        opacity: 0.9;
        transform: translateY(-2px);
    }
</style>
{% endblock %}

